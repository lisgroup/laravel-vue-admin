(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-284dbcb6"],{1:function(e,t){},2:function(e,t){},3:function(e,t){},4721:function(e,t,a){},"74d6":function(e,t,a){"use strict";a("4721")},e445:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("nav-bar"),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{data:e.dataObj,action:e.uploadUrl,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.beforeUpload,"file-list":e.fileList}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("选取文件")]),e._v(" "),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传 Excel 文件，且不超过 500kb")])],1),e._v(" "),a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("数据预览")])]),e._v(" "),a("div",{staticClass:"text item"},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","highlight-current-row":""}},[a("el-table-column",{attrs:{label:e.tableTitle}},e._l(e.tableHeader,(function(e){return a("el-table-column",{key:e,attrs:{prop:e,label:e,"min-width":"150"}})})),1)],1)],1)]),e._v(" "),a("Footer")],1)},r=[],l=(a("34ef"),a("7f7f"),a("28a5"),a("1146")),n=a.n(l),s=a("b775"),i=a("cd4a"),c={name:"Excel",components:{Footer:i["b"]},data:function(){return{fileList:[],upLoadNumber:1e5,tableTitle:"",tableData:[],tableHeader:"",uploadUrl:"https://up.qiniup.com",dialogImageUrl:"",dialogVisible:!1,desc:"",dataObj:{}}},created:function(){var e=this;s["a"].get("/api/getToken").then((function(t){e.dataObj={token:t.data.token},console.log(e.dataObj)}))},methods:{submitUpload:function(){this.$refs.upload.submit()},handleRemove:function(e,t){console.log(e,t)},handlePreview:function(e){console.log(e)},beforeUpload:function(e){var t=this;return new Promise((function(a,o){t.readExcel(e).then((function(e){e&&a(e)}))}))},readExcel:function(e){console.log(e);var t=this;return new Promise((function(a,o){var r=new FileReader;r.onload=function(e){try{var r=e.target.result,l=n.a.read(r,{type:"binary"}),s=[];for(var i in console.log(l.SheetNames),l.SheetNames){console.log(i);var c=l.SheetNames[i],d=l.Sheets[c];for(var u in d)"!ref"!==u&&s.push(d[u])}var f=n.a.utils.sheet_to_json(l.Sheets[l.SheetNames[0]]);console.log(f);var p=l.SheetNames[0];console.log(p);var h=l.Sheets[l.SheetNames[0]],g=t.get_header_row(h);console.log(g);var v=n.a.utils.sheet_to_json(h);console.log(v),t.generateDate({tableTitle:p,header:g,results:v}),s.length>t.upLoadNumber?(console.log("不能超过"),a(!1)):a(!0)}catch(e){o(e.message)}},r.readAsBinaryString(e)}))},generateDate:function(e){var t=e.tableTitle,a=e.header,o=e.results;console.log(t),console.log(a),console.log(o),this.tableTitle=t,this.tableData=o,this.tableHeader=a},handleDrop:function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;if(1===t.length){var a=t[0];this.readerData(a),e.stopPropagation(),e.preventDefault()}else this.$message.error("Only support uploading one file!")},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},readerData:function(e){var t=this;if("xls"!==e.name.split(".")[1]&&"xlsx"!==e.name.split(".")[1])this.$message({message:"上传文件格式错误，请上传xls、xlsx文件！",type:"warning"});else{var a=new FileReader;a.onload=function(e){var a=e.target.result,o=t.fixdata(a),r=n.a.read(btoa(o),{type:"base64"}),l=r.SheetNames[0];console.log(l);var s=r.Sheets[l],i=s["!ref"].split(":")[1];s["!ref"]="A2:".concat(i);var c=l,d=t.get_header_row(s);console.log(d);var u=n.a.utils.sheet_to_json(s);console.log(u),t.generateDate({tableTitle:c,header:d,results:u})},a.readAsArrayBuffer(e)}},fixdata:function(e){var t="",a=0,o=10240;for(a=0;a<e.byteLength/o;++a)return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*o,a*o+o))),t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(a*o))),t},get_header_row:function(e){var t,a=[],o=n.a.utils.decode_range(e["!ref"]),r=o.s.r;for(t=o.s.c;t<=o.e.c;++t){var l=e[n.a.utils.encode_cell({c:t,r:r})],s="UNKNOWN "+t;s=n.a.utils.format_cell(l),a.push(s)}return a}}},d=c,u=(a("74d6"),a("2877")),f=Object(u["a"])(d,o,r,!1,null,"6501a041",null);t["default"]=f.exports}}]);